# avitobot
avitobot - бот, с помощью которого можно отслеживать объявления на Авито: появления
новых, изменения цен на старых, общая статистика по объявлениям (по конкретным запросам).
С помощью этого бота можно вести перепродажный бизнес.

Функционал:
- Получать статистику по запросу (средняя цена, кол-во объявлений, min/max цена)
- Получать уведомления о появлении новых объявлений по запросу
- Получать уведомления о изменении цен на уже опубликованные объявление по запросу

по запросам - будем сохранять в питонский словарь, если юзер добавляет его в
отслеживание - тогда в таблицу

/status - здесь будет настройки города, количество и список активных запросов для
поиска объявлений

после того, как приходит запрос на отслеживание:
- повторяем запрос, сохраняем его результаты в таблицу `request_result`, там будет
только одна строка для каждого запроса, в которой будем обновлять значения
- все пришедшие объявления сохраняем в отдельную таблицу, с уникальными `avito_id`
и всеми параметрами - будем обновлять эти значения при изменениях, и добавлять 
новые при наличии таковых

## TODO
TODO:
- [x] Спарсить объявления со всех страниц, а не с одной
- [x] Сделать настройку города и форматирование ссылки по нему /city
- [x] Сделать настройку интервала /interval
- [x] Сделать настройку пинга /ping
- [x] Сделать вывод настроек /status
- [x] Сделать сохранение данных о запросе и всех объявлений по нему в БД
- [x] Ожидание, пока с полями цен можно будет интерактировать, чтобы избежать
ошибки `ElementNotInteractableException`
- [x] Разобраться с асинхронностью и доступностью бота, распределением нагрузки
(когда включил отслеживание объявлений, бот блокался и не отвечал, пока парсил 
объявления в браузере)
- [ ] Сделать отслеживание запроса и всех объявлений по нему и уведомления при изменениях

С асинхронностью два варианта:
- юзать асинк вебдрайвер либу - arsenic
- навести суету с очередями, redis, потоками

## UPDATE for branch `arsenic-test`
Вместо selenium взял асинхронную вебдрайвер либу [arsenic](https://github.com/HENNGE/arsenic).
Бот стал намного отзывчивее, в целом на протяжении всего процесса парсинга на 
другие команды отвечает.

